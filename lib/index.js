'use strict';const a18_0x4cc98a=a18_0x410c;(function(_0x2eb7fb,_0x1de973){const _0x4b1abf=a18_0x410c,_0x3ce189=_0x2eb7fb();while(!![]){try{const _0x32f839=-parseInt(_0x4b1abf(0x12e))/0x1+parseInt(_0x4b1abf(0x169))/0x2*(parseInt(_0x4b1abf(0x162))/0x3)+-parseInt(_0x4b1abf(0x182))/0x4*(parseInt(_0x4b1abf(0x17f))/0x5)+-parseInt(_0x4b1abf(0x147))/0x6*(-parseInt(_0x4b1abf(0x15d))/0x7)+parseInt(_0x4b1abf(0x15a))/0x8*(-parseInt(_0x4b1abf(0x153))/0x9)+parseInt(_0x4b1abf(0x165))/0xa*(parseInt(_0x4b1abf(0x189))/0xb)+-parseInt(_0x4b1abf(0x17d))/0xc*(-parseInt(_0x4b1abf(0x140))/0xd);if(_0x32f839===_0x1de973)break;else _0x3ce189['push'](_0x3ce189['shift']());}catch(_0x52974a){_0x3ce189['push'](_0x3ce189['shift']());}}}(a18_0x3f5d,0x6313c));var __awaiter=this&&this[a18_0x4cc98a(0x139)]||function(_0x12be85,_0x608964,_0x9620ad,_0x305ec1){function _0x6801c1(_0x1c8673){return _0x1c8673 instanceof _0x9620ad?_0x1c8673:new _0x9620ad(function(_0xa16b58){_0xa16b58(_0x1c8673);});}return new(_0x9620ad||(_0x9620ad=Promise))(function(_0xd0ae30,_0xee8929){const _0x6c5cba=a18_0x410c;function _0x3d3e83(_0x52323a){const _0x1b98d6=a18_0x410c;try{_0x4cfb0f(_0x305ec1[_0x1b98d6(0x155)](_0x52323a));}catch(_0x36f571){_0xee8929(_0x36f571);}}function _0x3d4048(_0xa41be4){const _0x2eee7b=a18_0x410c;try{_0x4cfb0f(_0x305ec1[_0x2eee7b(0x14a)](_0xa41be4));}catch(_0x39155a){_0xee8929(_0x39155a);}}function _0x4cfb0f(_0x387120){const _0x2b60ff=a18_0x410c;_0x387120[_0x2b60ff(0x150)]?_0xd0ae30(_0x387120[_0x2b60ff(0x15f)]):_0x6801c1(_0x387120[_0x2b60ff(0x15f)])[_0x2b60ff(0x176)](_0x3d3e83,_0x3d4048);}_0x4cfb0f((_0x305ec1=_0x305ec1[_0x6c5cba(0x132)](_0x12be85,_0x608964||[]))[_0x6c5cba(0x155)]());});},__importDefault=this&&this[a18_0x4cc98a(0x173)]||function(_0x2b2117){const _0x2becee=a18_0x4cc98a;return _0x2b2117&&_0x2b2117[_0x2becee(0x129)]?_0x2b2117:{'default':_0x2b2117};};function a18_0x410c(_0x42e507,_0x57bcfb){const _0x3f5d8a=a18_0x3f5d();return a18_0x410c=function(_0x410c69,_0x2b604d){_0x410c69=_0x410c69-0x128;let _0x4cc272=_0x3f5d8a[_0x410c69];return _0x4cc272;},a18_0x410c(_0x42e507,_0x57bcfb);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a18_0x4cc98a(0x17b)]=void 0x0;function a18_0x3f5d(){const _0x1d3cb8=['3644WdkGoF','./crypto/DigestHelper','verify','data','oids','./error/InvalidAccessTokenTypeError','application/json','55CZDVqt','CAMDIGIKEY_SERVER_BASED_URL','ACCESS_TOKEN_REQUEST_URL','__esModule','LOGOUT_USER_ACCESS_TOKEN_URL','publicKey','CAMDIGIKEY_CLIENT_KEYSTORE_FILE','Invalid\x20user\x20access\x20token\x20signature.','652574QuyfiB','post','encode','CERTIFICATE','apply','getLoginToken','node-forge','status','error','spki','verifyAccountToken','__awaiter','_cacheService','end','./cache/CamDigiKeyMemoryCache','digest','getUserAccessToken','readFileSync','26rdXgep','Invalid\x20auth\x20token\x20signature.','requestToServer','CAMDIGIKEY_API','CAMDIGIKEY_CLIENT_TRUST_STORE_FILE','validateTokenSignature','./crypto/Wrapper','444AdqBEG','env','./error/InvalidTokenSignatureError','throw','init','logoutAccessToken','request','pem','createVerify','done','fromDer','message','4687803OLDfpP','asn1','next','certBag','Error\x20requesting\x20to\x20CamDigiKey\x20Server.','string','ACCESS_TOKEN_STATUS_URL','8RKluvF','base64','export','63553kVSQeI','pkcs12','value','includes','X509Certificate','78qWchFv','statusCode','getOrganizationAccessToken','8230yNjwgM','wrapRequest','validateJwt','CAMDIGIKEY_CLIENT_KEYSTORE_FILE_PASSWORD','37410sPLbdc','now','pki','invalid.token.format','length','./api','CAMDIGIKEY_CLIENT_DOMAIN','./error/CamDigiKeyError','default','CAMDIGIKEY_CLIENT_TRUST_STORE_FILE_PASSWORD','__importDefault','Invalid\x20access\x20token\x20signature','getBags','then','from','CAMDIGIKEY_CLIENT_ID','VERIFY_USER_PROFILE','invalid.token.type','CamDigiKeyClient','crypto','2720460tpiDnY','ORG_ACCESS_TOKEN_URL','200ULTgwe','_trustedRootCert','agentOptions'];a18_0x3f5d=function(){return _0x1d3cb8;};return a18_0x3f5d();}const Wrapper_1=__importDefault(require(a18_0x4cc98a(0x146))),CamDigiKeyError_1=__importDefault(require(a18_0x4cc98a(0x170))),InvalidAccessTokenTypeError_1=__importDefault(require(a18_0x4cc98a(0x187))),DigestHelper_1=__importDefault(require(a18_0x4cc98a(0x183))),CamDigiKeyMemoryCache_1=__importDefault(require(a18_0x4cc98a(0x13c))),InvalidTokenSignatureError_1=__importDefault(require(a18_0x4cc98a(0x149))),fs_1=__importDefault(require('fs')),request_1=__importDefault(require(a18_0x4cc98a(0x14d))),crypto_1=__importDefault(require(a18_0x4cc98a(0x17c))),node_forge_1=__importDefault(require(a18_0x4cc98a(0x134))),api_1=require(a18_0x4cc98a(0x16e)),CamDigiKeyClient=class{static[a18_0x4cc98a(0x14b)](){const _0x1bd2a8=a18_0x4cc98a,_0x2ee2e0=fs_1[_0x1bd2a8(0x171)]['readFileSync'](String(process[_0x1bd2a8(0x148)][_0x1bd2a8(0x144)]),'binary'),_0x45b74f=node_forge_1[_0x1bd2a8(0x171)][_0x1bd2a8(0x154)][_0x1bd2a8(0x151)](_0x2ee2e0),_0x32eb58=node_forge_1['default'][_0x1bd2a8(0x15e)]['pkcs12FromAsn1'](_0x45b74f,String(process['env'][_0x1bd2a8(0x172)])),_0x489dc7=_0x32eb58[_0x1bd2a8(0x175)]({'bagType':node_forge_1[_0x1bd2a8(0x171)][_0x1bd2a8(0x16b)][_0x1bd2a8(0x186)]['certBag']}),_0x4f0d1c=_0x489dc7[node_forge_1[_0x1bd2a8(0x171)]['pki'][_0x1bd2a8(0x186)][_0x1bd2a8(0x156)]][0x0],_0x1820fd={'type':_0x1bd2a8(0x131),'body':node_forge_1['default'][_0x1bd2a8(0x154)]['toDer'](_0x4f0d1c[_0x1bd2a8(0x154)])['getBytes']()},_0x2f2b5f=node_forge_1[_0x1bd2a8(0x171)][_0x1bd2a8(0x14e)][_0x1bd2a8(0x130)](_0x1820fd);this[_0x1bd2a8(0x180)]=new crypto_1[(_0x1bd2a8(0x171))][(_0x1bd2a8(0x161))](_0x2f2b5f),this['_cacheService']=new CamDigiKeyMemoryCache_1['default'](this[_0x1bd2a8(0x180)]);}static[a18_0x4cc98a(0x142)](_0x3cf8c4,_0x4c3a7e){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xb0960c=a18_0x410c;try{const _0x1523ab=String(process[_0xb0960c(0x148)][_0xb0960c(0x18a)])+_0x4c3a7e,_0x232ad0=Wrapper_1[_0xb0960c(0x171)][_0xb0960c(0x166)](_0x3cf8c4),_0x25a8c9={'url':_0x1523ab,'headers':{'Content-Type':_0xb0960c(0x188)},'json':_0x232ad0};return process[_0xb0960c(0x148)][_0xb0960c(0x12c)]&&(_0x25a8c9[_0xb0960c(0x181)]={'pfx':fs_1[_0xb0960c(0x171)][_0xb0960c(0x13f)](String(process[_0xb0960c(0x148)][_0xb0960c(0x12c)])),'passphrase':String(process['env'][_0xb0960c(0x168)])}),yield new Promise(_0x47502a=>{const _0x19e424=_0xb0960c;request_1['default'][_0x19e424(0x12f)](_0x25a8c9,(_0x57f75f,_0xcdcfa6,_0x29a207)=>{const _0x444c6a=_0x19e424;if(!_0x57f75f){if(_0xcdcfa6[_0x444c6a(0x163)]>=0xc8&&_0xcdcfa6[_0x444c6a(0x163)]<0x12c){if(_0x29a207!=null)try{const _0x2c7299=Wrapper_1[_0x444c6a(0x171)]['unwrapResponse'](_0x29a207);return _0x47502a(_0x2c7299);}catch(_0x2d2a17){throw _0x2d2a17;}else return _0x47502a({});}throw new CamDigiKeyError_1[(_0x444c6a(0x171))](_0x444c6a(0x157));}else throw new CamDigiKeyError_1[(_0x444c6a(0x171))](_0x57f75f['message']);});});}catch(_0x3055c4){throw new CamDigiKeyError_1[(_0xb0960c(0x171))](_0x3055c4[_0xb0960c(0x152)]);}});}static[a18_0x4cc98a(0x145)](_0x4a02a7){var _0x146dd7;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2f5899=a18_0x410c;!this[_0x2f5899(0x13a)]&&this['init']();if(typeof _0x4a02a7!==_0x2f5899(0x158))throw new InvalidAccessTokenTypeError_1[(_0x2f5899(0x171))](_0x2f5899(0x17a));_0x4a02a7[_0x2f5899(0x160)]('%')&&(_0x4a02a7=decodeURIComponent(_0x4a02a7));try{const _0x572f4d=_0x4a02a7['split']('.');if(_0x572f4d[_0x2f5899(0x16d)]!==0x3)throw new InvalidAccessTokenTypeError_1[(_0x2f5899(0x171))](_0x2f5899(0x16c));const _0x5a8d9b=_0x572f4d[0x0]+'.'+_0x572f4d[0x1],_0x3dc521=DigestHelper_1[_0x2f5899(0x171)][_0x2f5899(0x13d)](Buffer[_0x2f5899(0x177)](_0x5a8d9b)),_0x430e27=yield(_0x146dd7=this[_0x2f5899(0x13a)])===null||_0x146dd7===void 0x0?void 0x0:_0x146dd7['signerCertificate'](),_0x464fa8=Buffer['from'](_0x572f4d[0x2],_0x2f5899(0x15b)),_0x26f3da=_0x430e27===null||_0x430e27===void 0x0?void 0x0:_0x430e27[_0x2f5899(0x12b)],_0x4d3313=_0x26f3da[_0x2f5899(0x15c)]({'type':_0x2f5899(0x137),'format':'pem'}),_0x2a9cb2=crypto_1[_0x2f5899(0x171)][_0x2f5899(0x14f)]('sha512');_0x2a9cb2['write'](_0x3dc521),_0x2a9cb2[_0x2f5899(0x13b)]();const _0x195078=_0x2a9cb2[_0x2f5899(0x184)](Buffer[_0x2f5899(0x177)](_0x4d3313),_0x464fa8);return _0x195078;}catch(_0x257aad){return console[_0x2f5899(0x136)](_0x257aad),![];}});}static[a18_0x4cc98a(0x167)](_0x382273){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x39de07=a18_0x410c;if(yield this[_0x39de07(0x145)](_0x382273)){_0x382273['includes']('%')&&(_0x382273=decodeURIComponent(_0x382273));const _0x35c129={'clientId':process[_0x39de07(0x148)][_0x39de07(0x178)],'accessToken':_0x382273};try{let _0x263bde=yield this['requestToServer'](_0x35c129,api_1[_0x39de07(0x143)][_0x39de07(0x159)]);if(_0x263bde[_0x39de07(0x185)][_0x39de07(0x135)])return{'is_valid':!![],'payload':_0x263bde};}catch(_0x7b1507){}}return{'is_valid':![],'payload':null};});}static[a18_0x4cc98a(0x164)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xc52482=a18_0x410c,_0x138818={'clientId':process[_0xc52482(0x148)][_0xc52482(0x178)],'domain':process[_0xc52482(0x148)]['CAMDIGIKEY_CLIENT_DOMAIN'],'requestedDate':Date[_0xc52482(0x16a)]()};return yield this['requestToServer'](_0x138818,api_1[_0xc52482(0x143)][_0xc52482(0x17e)]);});}static[a18_0x4cc98a(0x133)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x9126b9=a18_0x410c,_0x40694f={'clientId':process[_0x9126b9(0x148)]['CAMDIGIKEY_CLIENT_ID'],'domain':process[_0x9126b9(0x148)][_0x9126b9(0x16f)],'requestedDate':Date[_0x9126b9(0x16a)]()};return yield this[_0x9126b9(0x142)](_0x40694f,api_1['CAMDIGIKEY_API']['LOGIN_TOKEN_REQUEST_URL']);});}static[a18_0x4cc98a(0x13e)](_0x4203a5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x20de2b=a18_0x410c;if(!(yield this[_0x20de2b(0x145)](_0x4203a5)))throw new InvalidTokenSignatureError_1[(_0x20de2b(0x171))](_0x20de2b(0x141));_0x4203a5[_0x20de2b(0x160)]('%')&&(_0x4203a5=decodeURIComponent(_0x4203a5));const _0x4b3680={'clientId':process[_0x20de2b(0x148)][_0x20de2b(0x178)],'authToken':_0x4203a5};return yield this[_0x20de2b(0x142)](_0x4b3680,api_1[_0x20de2b(0x143)][_0x20de2b(0x128)]);});}static['refreshUserAccessToken'](_0xfcc5e){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3b38cb=a18_0x410c;if(!(yield this[_0x3b38cb(0x145)](_0xfcc5e)))throw new InvalidTokenSignatureError_1[(_0x3b38cb(0x171))](_0x3b38cb(0x12d));_0xfcc5e['includes']('%')&&(_0xfcc5e=decodeURIComponent(_0xfcc5e));const _0x559380={'clientId':process['env']['CAMDIGIKEY_CLIENT_ID'],'accessToken':_0xfcc5e};return yield this[_0x3b38cb(0x142)](_0x559380,api_1['CAMDIGIKEY_API']['ACCESS_TOKEN_REFRESH_URL']);});}static[a18_0x4cc98a(0x14c)](_0x391ea5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5ae96a=a18_0x410c;if(!(yield this['validateTokenSignature'](_0x391ea5)))throw new InvalidTokenSignatureError_1[(_0x5ae96a(0x171))](_0x5ae96a(0x12d));_0x391ea5[_0x5ae96a(0x160)]('%')&&(_0x391ea5=decodeURIComponent(_0x391ea5));const _0x30a8a1={'clientId':process[_0x5ae96a(0x148)][_0x5ae96a(0x178)],'accessToken':_0x391ea5};return yield this[_0x5ae96a(0x142)](_0x30a8a1,api_1[_0x5ae96a(0x143)][_0x5ae96a(0x12a)]);});}static['lookupUserProfile'](_0x402679,_0x32453d){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x82e8f3=a18_0x410c;if(!(yield this[_0x82e8f3(0x145)](_0x402679)))throw new InvalidTokenSignatureError_1[(_0x82e8f3(0x171))](_0x82e8f3(0x174));_0x402679[_0x82e8f3(0x160)]('%')&&(_0x402679=decodeURIComponent(_0x402679));const _0x2cec92={'clientId':process[_0x82e8f3(0x148)]['CAMDIGIKEY_CLIENT_ID'],'domain':process[_0x82e8f3(0x148)]['CAMDIGIKEY_CLIENT_DOMAIN'],'accessToken':_0x402679,'personalCode':_0x32453d};return yield this['requestToServer'](_0x2cec92,api_1['CAMDIGIKEY_API']['LOOKUP_USER_PROFILE']);});}static[a18_0x4cc98a(0x138)](_0x5132a4){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2600a5=a18_0x410c;if(!(yield this[_0x2600a5(0x145)](_0x5132a4)))throw new InvalidTokenSignatureError_1['default']('Invalid\x20access\x20token\x20signature');_0x5132a4['includes']('%')&&(_0x5132a4=decodeURIComponent(_0x5132a4));const _0x394499={'clientId':process[_0x2600a5(0x148)][_0x2600a5(0x178)],'domain':process['env'][_0x2600a5(0x16f)],'accountToken':_0x5132a4};return yield this[_0x2600a5(0x142)](_0x394499,api_1[_0x2600a5(0x143)][_0x2600a5(0x179)]);});}};exports[a18_0x4cc98a(0x17b)]=CamDigiKeyClient;